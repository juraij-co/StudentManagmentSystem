<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>

<VBox spacing="20" xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.juru.TimetableController"
      style="-fx-padding: 25; -fx-background-color: #f8f9fa;">
    
    <!-- Header Section -->
    <HBox alignment="CENTER_LEFT" style="-fx-padding: 0 0 10 0;">
        <Label text="Timetable Management" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #343a40;" />
        <Region HBox.hgrow="ALWAYS" />
        <Button text="← Back to Dashboard" style="-fx-background-color: #6c757d; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 8 15;" />
    </HBox>

    <!-- Selection Panel -->
    <VBox spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8;">
        <Label text="Select Academic Details" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #495057;" />
        <HBox spacing="15" alignment="CENTER_LEFT">
            <VBox spacing="5">
                <Label text="Department" style="-fx-font-weight: bold; -fx-text-fill: #495057;" />
                <ComboBox fx:id="ttDepartmentCombo" promptText="Choose Department" style="-fx-pref-width: 200; -fx-pref-height: 35;" />
            </VBox>
            <VBox spacing="5">
                <Label text="Course" style="-fx-font-weight: bold; -fx-text-fill: #495057;" />
                <ComboBox fx:id="ttCourseCombo" promptText="Choose Course" style="-fx-pref-width: 200; -fx-pref-height: 35;" />
            </VBox>
            <VBox spacing="5">
                <Label text="Semester" style="-fx-font-weight: bold; -fx-text-fill: #495057;" />
                <ComboBox fx:id="ttSemesterCombo" promptText="Choose Semester" style="-fx-pref-width: 200; -fx-pref-height: 35;" />
            </VBox>
            <Region HBox.hgrow="ALWAYS" />
            <VBox spacing="5" style="-fx-padding: 15 0 0 0;">
                <Button text="Load Subjects" fx:id="loadSubjectsBtn"
                        style="-fx-background-color: #007bff; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-pref-height: 35; -fx-pref-width: 120;" />
            </VBox>
        </HBox>
    </VBox>

    <!-- Main Content Area -->
    <HBox spacing="20" alignment="TOP_LEFT">
        <!-- Subjects Panel -->
        <VBox spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8; -fx-pref-width: 280;">
            <HBox alignment="CENTER_LEFT">
                <Label text="📚 Available Subjects" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #495057;" />
                <Region HBox.hgrow="ALWAYS" />
                <Label fx:id="subjectCountLabel" text="0 subjects" style="-fx-text-fill: #6c757d; -fx-font-size: 12px;" />
            </HBox>
            
            <Label text="Drag and drop subjects to timetable slots" style="-fx-text-fill: #6c757d; -fx-font-size: 12px; -fx-wrap-text: true;" />
            
            <ListView fx:id="subjectsListView" style="-fx-pref-height: 400; -fx-border-color: #e9ecef; -fx-border-radius: 4;" />
        </VBox>

        <!-- Timetable Grid Section -->
        <VBox spacing="15" style="-fx-pref-width: 1; -fx-vgrow: ALWAYS;">
            <HBox alignment="CENTER_LEFT">
                <Label text="🗓️ Weekly Timetable" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #495057;" />
                <Region HBox.hgrow="ALWAYS" />
                <Button text="Clear All" style="-fx-background-color: #6c757d; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 5 15;" />
                <Button text="Generate Auto" style="-fx-background-color: #17a2b8; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 5 15;" />
            </HBox>

            <!-- Timetable Grid Container -->
            <VBox style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 8, 0, 0, 2);">
                <!-- Grid Header -->
                <GridPane fx:id="timetableGrid" hgap="1" vgap="1" style="-fx-border-color: #dee2e6; -fx-border-width: 1;">
                    <!-- Columns will be dynamically created in controller -->
                    <!-- Structure: 
                         Column 0: Day headers (vertical)
                         Row 0: Period headers (horizontal)
                         Rest: Timetable slots
                    -->
                </GridPane>
                
                <!-- Timetable Legend -->
                <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-padding: 15 0 0 0;">
                    <Label text="Legend:" style="-fx-font-weight: bold; -fx-text-fill: #495057;" />
                    <HBox spacing="5" alignment="CENTER_LEFT">
                        <Rectangle width="15" height="15" fill="#e3f2fd" stroke="#bbdefb" />
                        <Label text="Lecture" style="-fx-text-fill: #495057; -fx-font-size: 12px;" />
                    </HBox>
                    <HBox spacing="5" alignment="CENTER_LEFT">
                        <Rectangle width="15" height="15" fill="#e8f5e8" stroke="#c8e6c9" />
                        <Label text="Lab" style="-fx-text-fill: #495057; -fx-font-size: 12px;" />
                    </HBox>
                    <HBox spacing="5" alignment="CENTER_LEFT">
                        <Rectangle width="15" height="15" fill="#fff3e0" stroke="#ffcc80" />
                        <Label text="Tutorial" style="-fx-text-fill: #495057; -fx-font-size: 12px;" />
                    </HBox>
                </HBox>
            </VBox>
        </VBox>
    </HBox>

    <!-- Action Buttons -->
    <HBox spacing="15" alignment="CENTER_RIGHT" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8;">
        <Region HBox.hgrow="ALWAYS" />
        <Label fx:id="ttStatusLabel" text="✅ Ready to create timetable" style="-fx-text-fill: #28a745; -fx-font-weight: bold; -fx-font-size: 13px;" />
        <Button text="Reset" style="-fx-background-color: #6c757d; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-pref-height: 35; -fx-pref-width: 100;" />
        <Button text="Save Timetable" fx:id="saveTimetableBtn"
                style="-fx-background-color: #28a745; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-pref-height: 35; -fx-pref-width: 120;" />
    </HBox>
</VBox>